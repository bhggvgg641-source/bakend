# مشروع Fashion AI المتكامل

هذا المشروع عبارة عن نظام ذكاء اصطناعي متكامل للأزياء يهدف إلى تقديم توصيات أزياء مخصصة للمستخدمين بناءً على بياناتهم الشخصية وصورهم، مع إمكانية البحث المتقدم عن المنتجات.

يتكون المشروع من:
-   **واجهة خلفية (Backend):** مبنية باستخدام Django REST Framework، وتتولى معالجة منطق الذكاء الاصطناعي، إدارة المستخدمين، والبحث عن المنتجات.
-   **واجهة أمامية (Frontend):** مبنية باستخدام React، وتوفر واجهة مستخدم تفاعلية للمستخدمين.

## الميزات الرئيسية

-   **تسجيل وإدارة المستخدمين:** نظام كامل لتسجيل الدخول وإدارة الملفات الشخصية للمستخدمين، بما في ذلك تخزين بياناتهم الجسدية (الطول، الوزن، لون البشرة) وصورهم الشخصية.
-   **تحليل الذكاء الاصطناعي:** استخدام نموذج Google Gemini 2.5 Flash لتحليل بيانات المستخدم وصورته الشخصية لاستخلاص خصائص الجسم، الألوان المناسبة، والأنماط المفضلة.
-   **توليد أوصاف وصور مرجعية:** بناءً على تحليل المستخدم، يقوم Gemini بتوليد أوصاف نصية دقيقة لقطع ملابس مقترحة، ثم يتم استخدام هذه الأوصاف (محاكاة حالياً) لتوليد صور مرجعية للملابس (بدون عارضين وعلى خلفية محايدة).
-   **البحث الصوري المتقدم:** استخدام SerpApi Google Lens API للبحث عن منتجات أزياء حقيقية مشابهة بصرياً للصور المرجعية المُولَّدة.
-   **توصيات مخصصة:** صياغة توصيات أزياء جذابة ومفصلة للمستخدم، مع روابط للمنتجات، وأوصاف تشرح سبب ملاءمتها.
-   **نظام التحميل الذكي المستمر (Infinite Scroll):** لتقديم تجربة تصفح سلسة للنتائج، مع جلب مسبق للبيانات.
-   **البحث المتقدم مع الفلاتر:** يتيح للمستخدمين تضييق نطاق البحث باستخدام فلاتر محددة (مثل اللون، نوع الملابس، المناسبة) بالإضافة إلى تحليلهم الشخصي.

## التعليمات: التشغيل المحلي (باستخدام Trea)

هذا القسم يوضح كيفية تشغيل المشروع بالكامل على جهازك المحلي باستخدام Trea، مع ربط الواجهة الأمامية والخلفية وتفعيل جميع الميزات. **الملفات المرفقة جاهزة للتشغيل ولا تتطلب أي تعديلات يدوية على الكود أو مفاتيح API.**

### **الخطوة 1: فك ضغط الملفات**

1.  **الواجهة الخلفية:** قم بفك ضغط `fashion_ai_backend.zip` إلى مجلد على جهازك. على سبيل المثال، `C:\Users\YourUser\Desktop\fashion_ai_backend\`.
2.  **الواجهة الأمامية:** قم بفك ضغط `fashion-ai-frontend-fixed.zip` إلى مجلد آخر. على سبيل المثال، `C:\Users\YourUser\Desktop\fashion_ai_frontend\`.

### **الخطوة 2: إعداد وتشغيل الواجهة الخلفية (Django Backend)**

1.  **افتح سطر أوامر (Terminal) جديد داخل Trea.**
2.  **انتقل إلى مجلد الواجهة الخلفية:**
    ```bash
    cd C:\Users\YourUser\Desktop\fashion_ai_backend
    ```
    *(استبدل المسار بالمسار الفعلي الذي فككت الضغط إليه)*
3.  **أنشئ بيئة افتراضية (اختياري ولكن موصى به):**
    ```bash
    python -m venv venv
    # لتفعيل البيئة الافتراضية على Windows:
    # .\venv\Scripts\activate
    # لتفعيل البيئة الافتراضية على macOS/Linux:
    # source venv/bin/activate
    ```
4.  **تثبيت التبعيات:**
    ```bash
    pip install -r requirements.txt
    ```
5.  **إعداد قاعدة البيانات (الهجرات):**
    *   **ملاحظة هامة:** هذه الخطوة ضرورية لمرة واحدة لإعداد قاعدة البيانات وإنشاء الجداول اللازمة للمستخدمين والصور. لا تحتاج إلى تعديل أي ملفات، فقط قم بتشغيل الأوامر التالية بالترتيب.
    ```bash
    python manage.py makemigrations users
    python manage.py migrate
    ```
6.  **تشغيل خادم Django:**
    ```bash
    python manage.py runserver 0.0.0.0:8000
    ```
    *اترك هذا الخادم يعمل في الخلفية. يجب أن ترى رسالة مثل `Starting development server at http://127.0.0.1:8000/`.*

### **الخطوة 3: إعداد وتشغيل الواجهة الأمامية (React Frontend)**

1.  **افتح سطر أوامر (Terminal) جديد داخل Trea.**
2.  **انتقل إلى مجلد الواجهة الأمامية:**
    ```bash
    cd C:\Users\YourUser\Desktop\fashion_ai_frontend
    ```
    *(استبدل المسار بالمسار الفعلي الذي فككت الضغط إليه)*
3.  **تثبيت التبعيات:**
    ```bash
    npm install
    # أو إذا كنت تستخدم yarn:
    # yarn install
    # أو إذا كنت تستخدم pnpm (كما هو الحال في بيئة الإنشاء): 
    # pnpm install
    ```
4.  **تشغيل خادم التطوير للواجهة الأمامية:**
    ```bash
    npm run dev
    # أو إذا كنت تستخدم yarn:
    # yarn dev
    # أو إذا كنت تستخدم pnpm: 
    # pnpm run dev
    ```
    *اترك هذا الخادم يعمل في الخلفية. سيقوم هذا الأمر عادةً بفتح المشروع في متصفح الويب الخاص بك على عنوان مثل `http://localhost:5173` (أو منفذ آخر). يرجى ملاحظة هذا العنوان.*

### **الخطوة 4: اختبار النظام في المتصفح**

1.  **افتح متصفح الويب الخاص بك** وانتقل إلى العنوان الذي أظهرته لك الواجهة الأمامية (مثال: `http://localhost:5173`).
2.  **سجل مستخدماً جديداً:** املأ البيانات المطلوبة وقم بتحميل صورة شخصية (يمكنك استخدام أي صورة من الإنترنت للاختبار).
3.  **استكشف التوصيات:** بعد التسجيل، انتقل إلى صفحة التوصيات. يجب أن ترى توصيات أزياء مخصصة لك.
4.  **اختبر التحميل اللانهائي:** قم بالتمرير لأسفل في صفحة التوصيات. يجب أن يتم جلب المزيد من النتائج تلقائياً.
5.  **اختبر البحث المتقدم:** انتقل إلى صفحة البحث المتقدم، أدخل بعض الفلاتر، وقم بإجراء البحث. تأكد من أن النتائج تتوافق مع الفلاتر وتحليلك الشخصي.

## استكشاف الأخطاء وإصلاحها (Troubleshooting)

إذا واجهت مشكلة "فشل في الاتصال بالخادم" أو "فشل في الحصول على توصيات الذكاء الاصطناعي"، يرجى التحقق مما يلي:

1.  **تأكد من أن خادم Django يعمل:**
    *   ارجع إلى نافذة Terminal التي تشغل خادم Django. هل ترى رسالة `Starting development server at http://127.0.0.1:8000/`؟
    *   هل هناك أي رسائل خطأ حمراء في سجلات خادم Django؟ إذا كان الأمر كذلك، يرجى تزويدي بها.
2.  **تأكد من أن خادم React يعمل:**
    *   ارجع إلى نافذة Terminal التي تشغل خادم React. هل ترى رسالة `ready in Xms` أو `Local: http://localhost:5173/`؟
    *   هل هناك أي رسائل خطأ في سجلات خادم React؟
3.  **تحقق من عنوان API في الواجهة الأمامية:**
    *   تأكد أن ملف `C:\Users\YourUser\Desktop\fashion_ai_frontend\src\lib\api.js` يحتوي على السطر التالي:
        ```javascript
        const API_BASE_URL = 'http://localhost:8000/api';
        ```
    *   إذا كان يشير إلى عنوان آخر، قم بتعديله (هذه هي الحالة الوحيدة التي قد تحتاج فيها لتعديل ملف).
4.  **مشاكل CORS:**
    *   في الواجهة الخلفية، تم تمكين `CORS_ALLOW_ALL_ORIGINS = True` في `fashion_ai_backend/settings.py` لتسهيل التطوير. هذا يجب أن يمنع مشاكل CORS. إذا استمرت المشكلة، تأكد من أن هذا الإعداد موجود.

## التعليمات: النشر السحابي (Netlify و Render)

لضمان سهولة النشر والتحديثات المستقبلية، يوصى برفع كل جزء من المشروع (الواجهة الخلفية والواجهة الأمامية) إلى مستودع GitHub منفصل.

### **الخطوة 1: إعداد مستودعات GitHub**

1.  **أنشئ مستودعين جديدين (Repositories) على GitHub:**
    *   واحد للواجهة الخلفية (مثال: `fashion-ai-backend`).
    *   واحد للواجهة الأمامية (مثال: `fashion-ai-frontend`).
2.  **ارفع ملفات الواجهة الخلفية إلى مستودع `fashion-ai-backend`:**
    *   افتح سطر أوامر (Terminal) جديد.
    *   انتقل إلى مجلد الواجهة الخلفية: `cd C:\Users\YourUser\Desktop\fashion_ai_backend`
    *   قم بتهيئة Git ورفع الملفات:
        ```bash
        git init
        git add .
        git commit -m "Initial commit"
        git branch -M main
        git remote add origin https://github.com/YOUR_GITHUB_USERNAME/fashion-ai-backend.git
        git push -u origin main
        ```
        *(استبدل `YOUR_GITHUB_USERNAME` باسم المستخدم الخاص بك على GitHub)*

3.  **ارفع ملفات الواجهة الأمامية إلى مستودع `fashion-ai-frontend`:**
    *   افتح سطر أوامر (Terminal) جديد.
    *   انتقل إلى مجلد الواجهة الأمامية: `cd C:\Users\YourUser\Desktop\fashion_ai_frontend`
    *   قم بتهيئة Git ورفع الملفات:
        ```bash
        git init
        git add .
        git commit -m "Initial commit"
        git branch -M main
        git remote add origin https://github.com/YOUR_GITHUB_USERNAME/fashion-ai-frontend.git
        git push -u origin main
        ```
        *(استبدل `YOUR_GITHUB_USERNAME` باسم المستخدم الخاص بك على GitHub)*

### **الخطوة 2: نشر الواجهة الخلفية (Django) على Render**

Render هي منصة ممتازة لاستضافة تطبيقات Python/Django.

1.  **إنشاء حساب على Render:**
    *   اذهب إلى [Render.com](https://render.com/) وقم بإنشاء حساب أو تسجيل الدخول.

2.  **ربط حساب GitHub:**
    *   في لوحة تحكم Render، اذهب إلى `Account Settings` -> `Git` وقم بربط حسابك على GitHub.

3.  **إنشاء خدمة ويب جديدة (Web Service):**
    *   في لوحة تحكم Render، انقر على `New` -> `Web Service`.
    *   اختر المستودع `fashion-ai-backend` من GitHub.
    *   **الإعدادات المقترحة:**
        *   **Name:** `fashion-ai-backend` (أو أي اسم تفضله)
        *   **Region:** اختر أقرب منطقة جغرافية لك.
        *   **Branch:** `main`
        *   **Root Directory:** اتركها فارغة (إذا كان مشروع Django في الجذر).
        *   **Runtime:** `Python 3`
        *   **Build Command:** `pip install -r requirements.txt && python manage.py collectstatic --noinput && python manage.py migrate`
        *   **Start Command:** `gunicorn fashion_ai_backend.wsgi:application`

4.  **متغيرات البيئة (Environment Variables):**
    *   **ملاحظة هامة:** تم تضمين مفاتيح API لـ Gemini و SerpAPI بالفعل في الكود. ستحتاج فقط إلى إضافة المتغيرات التالية:
        *   `SECRET_KEY`: قم بإنشاء مفتاح سري قوي (يمكنك استخدام `python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'` لإنشاء واحد).
        *   `DEBUG`: `False` (مهم جداً للإنتاج)
        *   `ALLOWED_HOSTS`: `YOUR_RENDER_URL` (استبدل بـ URL الذي سيعطيه لك Render لتطبيقك، مثال: `fashion-ai-backend.onrender.com`)

5.  **قاعدة البيانات (اختياري):**
    *   Render يوفر قاعدة بيانات PostgreSQL مجانية. يوصى باستخدامها في الإنتاج. يمكنك إنشاء قاعدة بيانات جديدة على Render وربطها بتطبيق Django الخاص بك. ستحتاج إلى تحديث `settings.py` لاستخدام PostgreSQL بدلاً من SQLite.

6.  **النشر:** انقر على `Create Web Service`. سيبدأ Render في بناء ونشر تطبيقك.

### **الخطوة 3: نشر الواجهة الأمامية (React) على Netlify**

Netlify هي منصة ممتازة لاستضافة تطبيقات الواجهة الأمامية الثابتة (Static Frontend Applications).

1.  **إنشاء حساب على Netlify:**
    *   اذهب إلى [Netlify.com](https://www.netlify.com/) وقم بإنشاء حساب أو تسجيل الدخول.

2.  **ربط حساب GitHub:**
    *   في لوحة تحكم Netlify، انقر على `Add new site` -> `Import an existing project`.
    *   اختر `Deploy with GitHub` وقم بربط حسابك على GitHub.

3.  **اختيار المستودع:**
    *   اختر المستودع `fashion-ai-frontend` من GitHub.

4.  **إعدادات النشر (Deploy Settings):**
    *   **Owner:** حسابك على GitHub.
    *   **Branch to deploy:** `main`
    *   **Base directory:** اتركها فارغة (إذا كان مشروع React في الجذر).
    *   **Build command:** `npm run build` (أو `yarn build` أو `pnpm build`)
    *   **Publish directory:** `dist` (لمشاريع Vite، وهو ما تم استخدامه هنا)

5.  **متغيرات البيئة (Environment Variables):**
    *   أضف متغير بيئة `VITE_API_URL` بقيمة عنوان URL للواجهة الخلفية التي نشرتها على Render.
    *   **مثال:** `VITE_API_URL=https://fashion-ai-backend.onrender.com/api` (استبدل بـ URL الفعلي لتطبيقك على Render)

6.  **النشر:** انقر على `Deploy site`. سيبدأ Netlify في بناء ونشر تطبيقك.

## ملاحظات هامة

-   **توليد الصور المرجعية:** حالياً، يتم محاكاة توليد الصور المرجعية بإنشاء صور وهمية. في تطبيق إنتاجي، ستحتاج إلى دمج نموذج توليد صور حقيقي (مثل DALL-E أو Stable Diffusion) أو استخدام خدمة توليد صور من Google إذا أصبحت متاحة بشكل عام عبر Gemini API.

-   **تخزين الصور:** يتم تخزين صور المستخدمين والصور المرجعية المُولَّدة محلياً في مجلد `media`. في بيئة الإنتاج، يوصى بشدة باستخدام خدمة تخزين سحابي (مثل AWS S3 أو Google Cloud Storage) لضمان التوسع والأمان.

-   **CORS:** تم تمكين `CORS_ALLOW_ALL_ORIGINS = True` في `settings.py` لتسهيل التطوير. يجب تعطيل هذا في الإنتاج وتحديد `CORS_ALLOWED_ORIGINS` بدقة ليشمل عنوان URL للواجهة الأمامية على Netlify.

-   **الأمان:** هذا المشروع يركز على إثبات المفهوم والوظائف الأساسية. في بيئة الإنتاج، يجب تطبيق ممارسات أمنية إضافية مثل المصادقة القوية، التخويل، التحقق من صحة المدخلات، وإدارة الأخطاء بشكل أفضل.

نأمل أن يكون هذا المشروع نقطة انطلاق ممتازة لرؤيتك!

